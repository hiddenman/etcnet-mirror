<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.14.0" />
		<meta name="keywords" content="Etcnet QoS,Etcnet/qos,Etcnet,Etcnet Firewall" />
		<link rel="stylesheet" type="text/css" href="/extensions/SearchSuggest/SearchSuggest.css" />
		<link rel="alternate" type="application/x-wiki" title="Править" href="http://www.altlinux.org/index.php?title=Etcnet_QoS&amp;action=edit" />
		<link rel="edit" title="Править" href="http://www.altlinux.org/index.php?title=Etcnet_QoS&amp;action=edit" />
		<link rel="shortcut icon" href="/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ALT Linux Wiki (ru)" />
		<link rel="copyright" href="/ALT_Linux_Wiki:Copyright" />
		<link rel="alternate" type="application/rss+xml" title="ALT Linux Wiki — RSS-лента" href="http://www.altlinux.org/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="ALT Linux Wiki — Atom-лента" href="http://www.altlinux.org/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:RecentChanges&amp;feed=atom" />
		<title>Etcnet QoS — ALT Linux Wiki</title>
		<link rel="stylesheet" href="/skins/common/shared.css?195" type="text/css" media="screen" />
		<link rel="stylesheet" href="/skins/common/commonPrint.css?195" type="text/css" media="print" />
		<link rel="stylesheet" href="/skins/monobook/main.css?195" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?195" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" media="print" />
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?195"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/skins";
		var wgArticlePath = "/$1";
		var wgScriptPath = "";
		var wgScript = "/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://www.altlinux.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Etcnet_QoS";
		var wgTitle = "Etcnet QoS";
		var wgAction = "view";
		var wgArticleId = "421";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "ru";
		var wgContentLanguage = "ru";
		var wgBreakFrames = false;
		var wgCurRevisionId = "8884";
		var wgVersion = "1.14.0";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = [",	.", " 	,"];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/skins/common/wikibits.js?195"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/extensions/SearchSuggest/SearchSuggest.js"></script>
		<script type="text/javascript">hookEvent("load", ss_ajax_onload);</script>
		<script type="text/javascript" src="/skins/common/ajax.js?195"></script>
		<script type="text/javascript" src="/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Etcnet_QoS skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Etcnet QoS</h1>
		<div id="bodyContent">
			<h3 id="siteSub">Материал из ALT Linux Wiki</h3>
			<div id="contentSub">(Перенаправлено с <a href="/index.php?title=Etcnet/qos&amp;redirect=no" title="Etcnet/qos">Etcnet/qos</a>)</div>
									<div id="jump-to-nav">Перейти к: <a href="#column-one">навигация</a>, <a href="#searchInput">поиск</a></div>			<!-- start content -->
			<table style="border:1px solid #AAA; background:#F9F9F9; width:200px; margin: 0 0 1em 1em; padding:.2em; text-align:center; float: right;" class="noprint">

<tr>
<td><a href="/%D0%A4%D0%B0%D0%B9%D0%BB:42px-Wikitext-ru.svg.png" class="image" title="Image:42px-Wikitext-ru.svg.png‎"><img alt="Image:42px-Wikitext-ru.svg.png‎" src="/images/0/05/42px-Wikitext-ru.svg.png" width="42" height="14" border="0" /></a>
</td></tr>
<tr>
<td> <b>Эту статью следует <a href="http://ru.wikipedia.org/wiki/Википедия:Викификация" class="external text" title="http://ru.wikipedia.org/wiki/Википедия:Викификация" rel="nofollow">викифицировать</a></b>.<br />
</td></tr></table>
<p><br />
</p>
<table id="toc" class="toc" summary="Содержание"><tr><td><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1"><a href="#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_QoS_.D0.B2_.2Fetc.2Fnet_.28.D1.80.D0.B5.D0.B4.D0.B0.D0.BA.D1.86.D0.B8.D1.8F_3.29"><span class="tocnumber">1</span> <span class="toctext">Настройка QoS в /etc/net (редакция 3)</span></a>
<ul>
<li class="toclevel-2"><a href="#.D0.9E.D0.B1.D1.89.D0.B0.D1.8F_.D1.82.D0.B5.D0.BE.D1.80.D0.B8.D1.8F"><span class="tocnumber">1.1</span> <span class="toctext">Общая теория</span></a></li>
<li class="toclevel-2"><a href="#.D0.9E.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D1.80.D0.B5.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"><span class="tocnumber">1.2</span> <span class="toctext">Описание реализации</span></a></li>
<li class="toclevel-2"><a href="#.D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_1"><span class="tocnumber">1.3</span> <span class="toctext">Пример 1</span></a></li>
<li class="toclevel-2"><a href="#.D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_2"><span class="tocnumber">1.4</span> <span class="toctext">Пример 2</span></a></li>
<li class="toclevel-2"><a href="#.D0.A3.D1.82.D0.B8.D0.BB.D0.B8.D1.82.D1.8B"><span class="tocnumber">1.5</span> <span class="toctext">Утилиты</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "показать"; var tocHideText = "убрать"; showTocToggle(); } </script>
<a name=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_QoS_.D0.B2_.2Fetc.2Fnet_.28.D1.80.D0.B5.D0.B4.D0.B0.D0.BA.D1.86.D0.B8.D1.8F_3.29" id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_QoS_.D0.B2_.2Fetc.2Fnet_.28.D1.80.D0.B5.D0.B4.D0.B0.D0.BA.D1.86.D0.B8.D1.8F_3.29"></a><h2><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=1" title="Править секцию: Настройка QoS в /etc/net (редакция 3)">править</a>]</span> <span class="mw-headline"> Настройка QoS в <a href="/Etcnet" title="Etcnet">/etc/net</a> (редакция 3) </span></h2>
<a name=".D0.9E.D0.B1.D1.89.D0.B0.D1.8F_.D1.82.D0.B5.D0.BE.D1.80.D0.B8.D1.8F" id=".D0.9E.D0.B1.D1.89.D0.B0.D1.8F_.D1.82.D0.B5.D0.BE.D1.80.D0.B8.D1.8F"></a><h3><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=2" title="Править секцию: Общая теория">править</a>]</span> <span class="mw-headline"> Общая теория </span></h3>
<p>QoS — quality of service (качество обслуживания) — общий термин, обозначающий технологии управления скоростными и временными характеристиками пропускаемого трафика.
Конфигурация выполняется для каждого интерфейса отдельно. Для этого создаётся древовидная структура, состоящая из дисциплин очередей и классов. Корень этой структуры — так называемая корневая дисциплина очереди, которая является обязательным атрибутом интерфейса. Увидеть её можно так:
</p>
<pre>$ /sbin/ip ad sh dev eth0
3: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 4c:00:10:3b:3e:f0 brd ff:ff:ff:ff:ff:ff
    inet 10.1.1.175/23 brd 10.1.1.255 scope global eth0</pre>
<p>В данном случае корневая дисциплина очереди — pfifo_fast (она назначается по умолчанию). Иерархия очередей и классов определяет, как именно будут обрабатываться исходящие с интерфейса пакеты: номинальная скорость, параметры допустимых кратковременных всплесков, правила переупорядочивания пакетов внутри очередей, условия взаимного заимствования полосы пропускания между объектами на одном уровне иерархии и прочие параметры, зависящие от конкретной используемой структуры. «Перпендикулярно» этому дереву существует набор фильтров, которые описывают прохождение пакетов по структуре. Наиболее популярными являются дисциплины очередей CBQ (class based queueing) и HTB (hierarchical token bucket).
Дерево CBQ формируется по довольно простым принципам:
</p>
<ul><li> пропускная способность корневой дисциплины очереди интерфейса равна физической пропускной способности интерфейса
</li><li> классы могут иметь своим родителем только дисциплину очереди
</li><li> решение о направлении пакета в класс принимается в дисциплине очереди с помощью фильтров
</li><li> если вам необходимо разделить класс на подклассы, то создайте вложенную дисциплину очереди, а далее делите её
</li></ul>
<p>Дерево HTB строится ещё проще:
</p>
<ul><li> классы могут содержать другие классы напрямую, без промежуточных дисциплин очередей
</li></ul>
<a name=".D0.9E.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D1.80.D0.B5.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8" id=".D0.9E.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D1.80.D0.B5.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"></a><h3><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=3" title="Править секцию: Описание реализации">править</a>]</span> <span class="mw-headline"> Описание реализации </span></h3>
<p>Общая идея реализации в /etc/net заключается в том, что иерархия объектов QoS представляется в виде дерева каталогов и файлов. Конфигурация начинается с каталога <tt>qos</tt>, располагающегося в каталоге конфигурации интерфейса. Далее в нём могут содержаться другие каталоги, которые представляют либо дисциплины очереди, либо классы. В каталогах дисциплин присутствуют файлы с названием <tt>qdisc</tt>, а в каталогах с классами — файлы <tt>class</tt>. Эти файлы содержат параметры дисциплин и классов. Фильтры располагаются в файлах с названием <tt>filter</tt>.
</p>
<a name=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_1" id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_1"></a><h3><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=4" title="Править секцию: Пример 1">править</a>]</span> <span class="mw-headline"> Пример 1 </span></h3>
<p>Рассмотрим пример конфигурации HTB, поставляемый с /etc/net: <a href="http://etcnet.org/examples/QoS-HTB-user-guide/1/qdisc" class="external free" title="http://etcnet.org/examples/QoS-HTB-user-guide/1/qdisc" rel="nofollow">http://etcnet.org/examples/QoS-HTB-user-guide/1/qdisc</a>
Так как дерево начинается с корневой дисциплины, то в каталоге <tt>qos</tt> будет содержаться только один каталог <tt>qos/1</tt>, а в нём будет содержаться файл <tt>qdisc</tt>:
</p>
<pre>[DIR] 1/                                       22-Aug-2005 14:13      -  
[TXT] qdisc                                    18-Mar-2005 11:06     1k</pre>
<p>Корневая дисциплина здесь имеет номер 1. Параметры корневой дисциплины простые: <tt>htb default 12</tt>. Корневая дисциплина кроме своих параметров содержит один класс в каталоге <tt>qos/1/1</tt>. Полным именем объекта будет 1:1. Левое число отсутствует в названии каталога, так как оно всегда равно идентификатору очереди. В файле <tt>qos/1/1/class</tt> содержатся параметры класса: <tt>htb rate 100kbps ceil 100kbps</tt>. Кроме этого, в каталогах <tt>qos/1/1/2</tt> и <tt>qos/1/1/12</tt> определено ещё два класса: 1:2 и 1:12. В файле <tt>qos/1/1/extra</tt> содержатся параметры, общие для классов 1:2 и 1:12: <tt>htb ceil 100kbps</tt>. Это необязательный файл, можно было бы поместить эти параметры в файлы <tt>qos/1/1/2/class</tt> и <tt>qos/1/1/12/class</tt>. Если у вас много классов на одном уровне, то файл <tt>extra</tt> поможет вынести общую часть «за скобки».
Класс 1:12 пуст, а класс 1:2 содержит 1:10 и 1:11. В файлах <tt>qos/1/1/2/10/filter</tt> и <tt>qos/1/1/2/11/filter</tt> содержатся описания фильтров по одному в каждой строке. Местоположение файла <tt>filter</tt> определяет, куда будут направлены пакеты, которые ему удовлетворяют. Для класса 1:10 будет использован один фильтр <tt>protocol ip prio 1 u32 match ip src 1.2.3.4 match ip dport 80 0xffff</tt>, что соответствует исходящему HTTP-трафику с адреса 1.2.3.4, а для класса 1:11 будет использован фильтр <tt>protocol ip prio 1 u32 match ip src 1.2.3.4</tt>, что соответствует всему исходящему трафику с адреса 1.2.3.4. Файлы <tt>class</tt> классов 1:10 и 1:11 содержат соответственно <tt>rate 30kbps</tt> и <tt>rate 10kbps</tt>.
</p>
<a name=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_2" id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80_2"></a><h3><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=5" title="Править секцию: Пример 2">править</a>]</span> <span class="mw-headline"> Пример 2 </span></h3>
<p>1. Я советую, поставив пакет etcnet, сначала спрятать куда-нибудь все каталоги интерфейсов из <tt>/etc/net/ifaces</tt> (кроме <tt>lo</tt>, <tt>default</tt> и <tt>unknown</tt>) и запустить <tt>/etc/net/scripts/initconf</tt>. Его выдачу сохранить и на основании этой выдачи организовать файл <tt>/etc/net/iftab</tt>, который определит логические имена интерфейсов. Например, одну сетевую карту можно из eth0 переименовать в соответствии с её макадресом в wan, другую — в lan. Я для себя использовал вместо wan имя провайдера (comcast), а вместо lan — придуманное самим имя локального домена своей сети 192.168.10.0/24 (menlo). Ну и дальше буду их использовать, чтобы не ошибиться где-нибудь заменяя их на более нейтральные типа wan и lan. Далее создайте каталоги с именами определёнными в таблице <tt>/etc/net/iftab</tt>, внутри <tt>/etc/ifaces</tt>. Я создал <tt>/etc/net/ifaces/comcast</tt> и <tt>/etc/net/ifaces/menlo</tt>. И положил туда нужные мне файлы <tt>options</tt>. Для внешней сети <tt>comcast</tt> достаточно определить TYPE и BOOTPROTO, я добавил строчку MODULE как того рекомендовал initconf:
</p>
<pre># cat &lt;&lt;EOF &gt;/etc/net/ifaces/comcast/options
TYPE=eth
BOOTPROTO=dhcp
MODULE=tulip
EOF</pre>
<p>Для интерфейса локальной сети menlo адрес задан статически, так что там кроме файла options ещё нужен файл ipv4address:
</p>
<pre># cat &lt;&lt;EOF &gt;/etc/net/ifaces/menlo/options
TYPE=eth
BOOTPROTO=static
MODULE=natsemi
EOF
# echo &quot;192.168.10.1/24&quot; &gt;/etc/net/ifaces/menlo/ipv4address</pre>
<p>2. Дальше настраиваете ip-forwarding и nat masquarading. За первый отвечает строчка
</p>
<pre>net.ipv4.ip_forward = 1</pre>
<p>в файле <tt>/etc/net/sysctl.conf</tt>, в то время как другое делается добавлением строки
<tt>masquerade out-iface comcast</tt>
в файл <tt>/etc/net/ifaces/default/fw/iptables/nat/POSTROUTING</tt>:
</p>
<pre>echo &quot;masquerade out-iface comcast&quot; &gt;&gt;/etc/net/ifaces/default/fw/iptables/nat/POSTROUTING</pre>
<p>После этого ваш раутер после # service network restart уже должен начать выполнять свою функцию разделения доступа в интернет.
</p><p>3. Далее я настраивал распознавание и маркирование пакетов, которым надо было обеспечить гарантированную ширину пропускания канала. Для меня это были два телефонных адаптера, которые не искажают звук только если им предоставлены 10 килобит в секунду. Эти адаптеры стоят в локальной сети и dhcp сервер по их мак-адресам даёт им статические адреса. Эти адреса я и использовал в качестве критерия для маркировки. Маркировка обеспечивается следующим образом:
</p>
<pre>#cat &lt;&lt;EOF &gt;/etc/net/ifaces/default/fw/iptables/mangle/PREROUTING
mark 21 if from 192.168.10.21 from-iface menlo
mark 22 if from 192.168.10.5 from-iface menlo
EOF</pre>
<p>Мысль для себя на будущее: наверно можно было маркировать по мак-адресу, и тем самым избежать необходимости настраивать статические адреса выдаваемые dhcpd.
</p><p>4. Ну а теперь остаётся самое настроить qos htb для идущего наружу интерфейса comcast.
</p>
<pre># # создаём дисциплину 1
# mkdir -p /etc/net/ifaces/comcast/qos/1

# # определяем что эта дисциплина - htb
# # и её дефолтный класс для неклассифицированного траффика 77.
# echo &quot;htb default 77&quot; &gt;/etc/net/ifaces/comcast/qos/1/qdisc

# # создаём корневой класс 1 (1:1)
# mkdir /etc/net/ifaces/comcast/qos/1/1

# # определяем ширину пропускания интерфейса (upload)
# echo &quot;htb rate 360kbit&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/class

# # организуем фильтр, направляющий весь траффик в класс 1:1
# #&nbsp;!!!Этого фильтра нет в примерах пакета etcnet   &nbsp;!!!
# #&nbsp;!!!(по крайней мере для версии etcnet-0.9.3-alt3)!!!
# #&nbsp;!!!Но он действительно нужен, без него трафик   &nbsp;!!!
# #&nbsp;!!! не проходит по вложенным классам            &nbsp;!!!
# echo &quot;proto ip prio 1 u32 match ip src 0.0.0.0/0&quot;  &gt;/etc/net/ifaces/comcast/qos/1/1/filter

# # создаём класс для первого телефонного адаптера
# mkdir /etc/net/ifaces/comcast/qos/1/1/21/

# # определяем для него ширину пропускания 80 килобит/сек.
# echo &quot;htb rate 80kbit&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/21/class

# # задаём фильтр этого класса, отбирающий для него пакеты с маркой &quot;21&quot;
# echo &quot;protocol ip prio 1 handle 21 fw&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/21/filter

# # создаём класс для второго телефонного адаптера
# mkdir /etc/net/ifaces/comcast/qos/1/1/22/

# # определяем для него ширину пропускания 80 килобит/сек.
# echo &quot;htb rate 80kbit&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/22/class

# # задаём фильтр этого класса, отбирающий для него пакеты с маркой &quot;22&quot;
# echo &quot;protocol ip prio 1 handle 22 fw&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/22/filter


# # создаём класс для дефолтного траффика:
# mkdir /etc/net/ifaces/comcast/qos/1/1/77/

# # определяем для него ширину пропускания 200 (= 360 - (80 + 80)) килобит/сек.
# # с возможностью заимствования неиспользуемого в данный момент траффика других классов
# # вплоть до 360kbit, то есть полной ширины исходящего канала
# echo &quot;htb rate 200kbit ceil 360kbit&quot; &gt;/etc/net/ifaces/comcast/qos/1/1/77/class</pre>
<p>Теперь телефонам будет предоставляться 80 килобит в секунду как только они того потребуют, а если они недоиспользуют эти 80kbit, всё оставшееся будет предоставляться другим соединениям.
</p><p>P.S Большое спасибо Денису Овсиенко за то, что объяснил, как правильно организовать иерархию фильтров, чтобы эта конструкция заработала.
</p>
<a name=".D0.A3.D1.82.D0.B8.D0.BB.D0.B8.D1.82.D1.8B" id=".D0.A3.D1.82.D0.B8.D0.BB.D0.B8.D1.82.D1.8B"></a><h3><span class="editsection">[<a href="/index.php?title=Etcnet_QoS&amp;action=edit&amp;section=6" title="Править секцию: Утилиты">править</a>]</span> <span class="mw-headline"> Утилиты </span></h3>
<ul><li> С 11/07/2006 в contrib находится скрипт eqos (по аналогии с efw), который предназначен для ручного управления <a href="/Etcnet/qos" title="Etcnet/qos" class="mw-redirect">qos</a> и умеет следующее:
</li></ul>
<dl><dd> <pre>/etc/net QoS handler
</dd></dl>
<p>Usage: ./eqos [iface] &lt;action&gt; [action options]
</p>
<pre>iface    - real interface name ('eth0' by default) or 'all' for all interfaces
action   - 'start','stop','restart','show|list','stat|stats'
</pre>
<pre>start    - start QoS for given interface
stop     - stop QoS for given interface
restart  - equivalent to 'stop' then 'start'
show     - list qdiscs, classes or filters on given interface
list     - same as 'show'
stat     - print statistics for qdiscs, classes or filters on given interface
stats    - same as 'stat'
</pre>
<p>Options for actions 'show' or 'list' and 'stat' or 'stats':
</p>
<pre>- one of 'qdisc' (by default), 'class' or 'filter'
</pre>
 - component specific options (e.g. 'parent')</pre>
<p><br />
</p>
<div class="NavFrame noprint" style="clear:both; margin-top:0em;">
<div class="NavHead" style="background: #ccf;font-weight:normal"><span style="font-weight:bold">etcnet</span>
</div>
<div class="NavContent" style="font-size:95%;">
<p><span><a href="/Etcnet" title="Etcnet">Etcnet</a></span>&nbsp;&bull;&#32;<span><a href="/Etcnet_Firewall" title="Etcnet Firewall">Etcnet Firewall</a></span>&nbsp;&bull;&#32;<span><strong class="selflink">Etcnet QoS</strong></span>
</p>
</div>
<div class="NavEnd">&nbsp;</div>
</div>

<!-- 
NewPP limit report
Preprocessor node count: 129/1000000
Post-expand include size: 1499/2097152 bytes
Template argument size: 174/2097152 bytes
Expensive parser function count: 0/100
-->
<div class="printfooter">
&nbsp;</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:Categories" title="Служебная:Categories">Категории</a>:&#32;<span dir='ltr'><a href="/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:Admin" title="Категория:Admin">Admin</a></span> | <span dir='ltr'><a href="/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BA_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8" title="Категория:Статьи к викификации">Статьи к викификации</a></span> | <span dir='ltr'><a href="/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:Etcnet" title="Категория:Etcnet">Etcnet</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Просмотры</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/Etcnet_QoS" title="Содержание статьи [c]" accesskey="c">Статья</a></li>
				 <li id="ca-talk" class="new"><a href="/index.php?title=%D0%9E%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5:Etcnet_QoS&amp;action=edit&amp;redlink=1" title="Обсуждение содержания страницы [t]" accesskey="t">Обсуждение</a></li>
				 <li id="ca-edit"><a href="/index.php?title=Etcnet_QoS&amp;action=edit" title="Эту страницу можно изменять. Используйте, пожалуйста, предварительный просмотр перед сохранением [e]" accesskey="e">Править</a></li>
				 <li id="ca-history"><a href="/index.php?title=Etcnet_QoS&amp;action=history" title="Журнал изменений страницы [h]" accesskey="h">История</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Личные инструменты</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:UserLogin&amp;returnto=Etcnet_QoS" title="Здесь можно зарегистрироваться в системе, но это необязательно. [o]" accesskey="o">Войти / зарегистрироваться</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/images/3/30/Alt_linux_team_small.png);" href="/%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0" title="Перейти на заглавную страницу [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Навигация</h5>
		<div class='pBody'>
			<ul>
				<li id="n-.D0.93.D0.BB.D0.B0.D0.B2.D0.BD.D0.B0.D1.8F-.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D0.B0"><a href="/%D0%93%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0">Главная страница</a></li>
				<li id="n-.D0.92.D1.81.D0.B5-.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D1.8B"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:AllPages">Все страницы</a></li>
				<li id="n-.D0.9A.D0.B0.D1.82.D0.B5.D0.B3.D0.BE.D1.80.D0.B8.D0.B8"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:Categories">Категории</a></li>
				<li id="n-recentchanges"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:RecentChanges" title="Список последних изменений [r]" accesskey="r">Свежие правки</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-.D0.A0.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D1.8B_wiki'>
		<h5>Разделы wiki</h5>
		<div class='pBody'>
			<ul>
				<li id="n-.D0.9A.D0.BD.D0.B8.D0.B3.D0.B8"><a href="/Books:Main_page">Книги</a></li>
				<li id="n-.D0.A0.D1.83.D0.BA.D0.BE.D0.B2.D0.BE.D0.B4.D1.81.D1.82.D0.B2.D0.B0"><a href="/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%A0%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B0">Руководства</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-.D0.9E_wiki'>
		<h5>О wiki</h5>
		<div class='pBody'>
			<ul>
				<li id="n-.D0.9F.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0"><a href="/ALT_Linux_Wiki:%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5">Правила</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-.D1.80.D0.B5.D0.B4.D0.B0.D0.BA.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5'>
		<h5>редактирование</h5>
		<div class='pBody'>
			<ul>
				<li id="n-.D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA-.D0.BA.D0.B0.D1.80.D1.82.D0.B8.D0.BD.D0.BE.D0.BA"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:ListFiles">Список картинок</a></li>
				<li id="n-.D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA-.D1.88.D0.B0.D0.B1.D0.BB.D0.BE.D0.BD.D0.BE.D0.B2"><a href="/%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D1%8B">Список шаблонов</a></li>
				<li id="n-.D0.9F.D0.B5.D1.81.D0.BE.D1.87.D0.BD.D0.B8.D1.86.D0.B0"><a href="/ALT_Linux_Wiki:%D0%9F%D0%B5%D1%81%D0%BE%D1%87%D0%BD%D0%B8%D1%86%D0%B0">Песочница</a></li>
				<li id="n-.D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0-.D0.BD.D0.B0.D0.B4-wiki"><a href="/ALT_Linux_Wiki:Main_Page">Работа над wiki</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D1.8C'>
		<h5>помощь</h5>
		<div class='pBody'>
			<ul>
				<li id="n-help"><a href="/ALT_Linux_Wiki:%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0" title="Справочник по проекту «ALT Linux Wiki»">Справка</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Поиск</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Искать это слово [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Перейти" title="Перейти к странице, имеющей в точности такое название" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Найти" title="Найти страницы, содержащие указанный текст" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Инструменты</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:WhatLinksHere/Etcnet_QoS" title="Список всех страниц, которые ссылаются на эту страницу [j]" accesskey="j">Ссылки сюда</a></li>
				<li id="t-recentchangeslinked"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:RecentChangesLinked/Etcnet_QoS" title="Последние изменения в страницах, на которые ссылается эта страница [k]" accesskey="k">Связанные правки</a></li>
<li id="t-specialpages"><a href="/%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:SpecialPages" title="Список служебных страниц [q]" accesskey="q">Спецстраницы</a></li>
				<li id="t-print"><a href="/index.php?title=Etcnet_QoS&amp;printable=yes" title="Версия для печати этой страницы [p]" accesskey="p">Версия для печати</a></li>				<li id="t-permalink"><a href="/index.php?title=Etcnet_QoS&amp;oldid=8884" title="Постоянная ссылка на эту версию страницы">Постоянная ссылка</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> &nbsp;</li>
					<li id="copyright">Содержимое доступно в соответствии с <a href="/ALT_Linux_Wiki:Copyright" title="ALT Linux Wiki:Copyright">CC-BY-SA-3.0</a>.</li>
					<li id="privacy"><a href="/ALT_Linux_Wiki:%D0%9F%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="ALT Linux Wiki:Политика конфиденциальности">Политика конфиденциальности</a></li>
					<li id="about"><a href="/ALT_Linux_Wiki:%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5" title="ALT Linux Wiki:Описание">Описание ALT Linux Wiki</a></li>
					<li id="disclaimer"><a href="/ALT_Linux_Wiki:%D0%9E%D1%82%D0%BA%D0%B0%D0%B7_%D0%BE%D1%82_%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="ALT Linux Wiki:Отказ от ответственности">Отказ от ответственности</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.543 secs. --></body></html>
